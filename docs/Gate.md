locale: `ru_RU` (native)

# Gate :: Вход, регистрация и аутефикация на сервере

В данный момент, для аутефикации используются т.н. **КЛЮЧИ** - просто случайные UUID, которые хранятся на сервере и в браузере клиента. Злоумышленник должен иметь доступ к устройству ИЛИ паролю пользователя.

## `POST /gate/connect`

Присоединиться к серверу.

Не важно - регистрация или вход (sign in / sign up)

- Регистрация: логин ИЛИ ключ пользователя не найдены в БД. Поиск по ключу сделан чтобы допустить смену ника
- Логин: если ключ совпадает => пропустить без пароля; если совпадает только ник => запросить пароль. При верном вводе пароля ключ **на клиенте** обновляется на ключ с сервера.

**REQ BODY:**

```ts
{
  login: string(len 3-20*)
  userkey?: string(len 1-1000)
}
```

\* modifiable for server administrators

**RESPONSE:**

```ts
//Дружеский сервер, пароль не нужен
// ИЛИ
//Логин и ключ совпадают (публичный сервер)
status: 200 //OK
body: {
  userId: string
}
//Действия после ответа: Отобразить список лобби
```

```ts
//Регистрация на публичном сервере
status: 401 //Unauthorized
body: {
  firstTime: true
}
//Действия после ответа: Показ формы для регистрации; отправка формы - POST /gate/register
```

```ts
//Ключи не совпадают (публичный сервер)
status: 401 //Unauthorized
body: {
  firstTime: false
}
//Действия после ответа: Показ формы для ввода пароля; отправка формы - POST /gate/auth
```

## `POST /gate/register`

Регистрация на сервере. В данный момент - только ввод пароля.

**REQ BODY:**

```ts
{
  login: string(len 3-20*)
  password: string(len 3-20*)
}
```

\* modifiable for server administrators

**RESPONSE:**

```ts
//Успешная регистрация
status: 200 //OK
body: {
  userkey: string
  userId: string
}
//Не забыть поместить ключ в localStorage
// и начать отправлять запросы с заголовком 'Authorization': 'userId userkey'
//Следующий шаг - запросить страницу самого сервера
```

## `POST /gate/auth`

Аутефикация пользователя (на данный момент - запрос пароля)

**REQ BODY:**

```ts
{
  login: string(len 3-20*)
  password: string(len 3-20*)
}
```

\* modifiable for server administrators

**RESPONSE:**

```ts
//Успешная регистрация
status: 200 //OK
body: {
  userkey: string
  userId: string
}
//Не забыть поместить ключ в localStorage
// и начать отправлять запросы с заголовком 'Authorization': 'userId userkey'
//Следующий шаг - запросить страницу самого сервера
```

```ts
//Неверный пароль
status: 406 //Not Acceptable
body: {
  availableTries: number(range 1-inf) //Кол-во доступных попыток на ввод пароля
}
//Если пользователь исчерпывает попытки - он получает блокировку по IP на сервере.
//Сам аккаунт не попадает под блокировку (оригинальный пользователь может в него зайти без проблем)
```
